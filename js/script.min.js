"use strict";$((function(){const t=["#F0001E","#E0001C","#D1001A","#C20018","#B20016","#0500D6","#0400C7","#0400B8","#0400A8","#030099"],e="https://flagcdn.com/{0}.svg",o="https://www.youtube.com/watch?v={0}";let i,n={},r=[],a=[];var s;function l(){i=new jvm.Map({map:"us_merc",container:$("#map"),backgroundColor:"#f0f0f0",zoomMin:.9,focusOn:{x:.5,y:.5,scale:.95},series:{regions:[{attribute:"fill"}]},onRegionClick:function(t,e){p(e)},onRegionTipShow:function(t,e,o){let i=n[o];i&&e.text("{0}: {1} ({2})".format(i.state,i.title,i.year))}}),i.series.regions[0].setValues(function(){let t={};for(let e in i.regions)t[e]=n[e]?n[e].colour:"#555555";return t}())}function c(){i&&(i.remove(),i=void 0)}function f(t,o,i,n){$(t).empty(),o.forEach((function(o){$("<span></span>").addClass("listFilm").prop({title:n(o),style:"background-color: {0}".format(o.colour)}).text(i(o)).click((function(){p(o.stateCode)})).prepend($("<img/>").prop({src:e.format(o.stateCode.toLowerCase()),alt:"State flag of {0}".format(o.state)}).on("error",(function(){$(this).hide()}))).appendTo(t)}))}function u(t){$(t).addClass("selected").siblings().removeClass("selected")}function m(t){$(t).show().siblings().hide()}function p(t){let i=n[t];i&&($("#filmState").text(i.state),$("#filmTitle").text(i.title),$("#filmYear").text(i.year),$("#filmStateFlag").prop({src:e.format(i.stateCode.toLowerCase()),alt:"State flag of {0}".format(i.state)}),$("#filmImageContainer").toggleClass("defaultImage",!i.image),$("#filmImage").prop({src:i.image,alt:"Film poster for {0}".format(i.title)}).toggle(!!i.image),$("#filmOriginalTitle").text(i.originalTitle).toggle(!!i.originalTitle),g("#imdbLink","https://www.imdb.com/title/{0}/",i.imdb),g("#letterboxdLink","https://letterboxd.com/film/{0}/",i.letterboxd),g("#rottenTomatoesLink","https://www.rottentomatoes.com/m/{0}",i.rottenTomatoes),g("#wikipediaLink","https://en.wikipedia.org/wiki/{0}",i.wikipedia),g("#justwatchLink","https://www.justwatch.com/uk/movie/{0}",i.justwatch),g("#trailerLink",o,i.trailer),g("#reviewLink",o,i.review),$("#filmReviewer").text(i.reviewer),$("#filmDetailsModal").modal())}function g(t,e,o){$(t).prop({href:e.format(o)}).toggle(!!o)}$("a").prop("target","_blank"),$("#btnShowMap").click((function(){u("#btnShowMap"),m("#sectionMap"),l()})),$("#btnShowListStates").click((function(){u("#btnShowListStates"),m("#sectionListStates"),c()})),$("#btnShowListMovies").click((function(){u("#btnShowListMovies"),m("#sectionListMovies"),c()})),$("#btnShowAbout").click((function(){u("#btnShowAbout"),m("#sectionAbout"),c()})),$("#filmStateFlag").on({error:function(){$(this).hide()},load:function(){$(this).show()}}),s=function(){$("#filmCount").text(r.length),l(),f("#listStates",r,(function(t){return t.state}),(function(t){return"{0} ({1})".format(t.title,t.year)})),f("#listMovies",a,(function(t){return"{0} ({1})".format(t.title,t.year)}),(function(t){return t.state}))},r=[],n={},$.getJSON("data/films.json",(function(e){e.forEach((function(e){e.colour=function(){let e=Math.floor(Math.random()*t.length);return t[e]}(),n[e.stateCode]=e})),r=e.sort((function(t,e){return t.state<e.state?-1:t.state>e.state?1:0})),a=e.slice().sort((function(t,e){let o=t.title.sortable(),i=e.title.sortable();return o<i?-1:o>i?1:0})),s()})),String.prototype.format=function(){let t=this;for(let e=0;e<arguments.length;e++)t=t.replace("{"+e+"}",arguments[e]);return t},String.prototype.sortable=function(){return this.replace(/^(A|The) /,"")}}));