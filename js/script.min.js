"use strict";$((function(){const t=["#E1002A","#CB003B","#B4004D","#990062","#850072","#6D0084","#540098","#3D00AA","#2600BC","#0E00CF"],e="https://www.youtube.com/watch?v={0}";let o,i={},n=[],a=[];var r;function s(){o=new jvm.Map({map:"us_merc",container:$("#map"),backgroundColor:"#f0f0f0",zoomMin:.9,focusOn:{x:.5,y:.5,scale:.95},series:{regions:[{attribute:"fill"}]},onRegionClick:function(t,e){m(e)},onRegionTipShow:function(t,e,o){let n=i[o];n&&e.text("{0}: {1} ({2})".format(n.state,n.title,n.year))}}),o.series.regions[0].setValues(function(){let t={};for(let e in o.regions)t[e]=i[e]?i[e].colour:"#d0d0d0";return t}())}function l(){o&&(o.remove(),o=void 0)}function c(t,e,o,i){$(t).empty(),e.forEach((function(e){$("<span></span>").addClass("listFilm").prop({title:i(e),style:"background-color: {0}".format(e.colour)}).text(o(e)).click((function(){m(e.stateCode)})).prepend($("<img/>").prop({src:g(e),alt:"State flag of {0}".format(e.state)}).on("error",(function(){$(this).hide()}))).appendTo(t)}))}function f(t){$(t).addClass("selected").siblings().removeClass("selected")}function u(t){$(t).show().siblings().hide()}function m(t){let o=i[t];o&&($("#filmState").text(o.state),$("#filmTitle").text(o.title),$("#filmYear").text(o.year),$("#filmStateFlag").prop({src:g(o),alt:"State flag of {0}".format(o.state)}),$("#filmImageContainer").toggleClass("defaultImage",!o.image),$("#filmImage").prop({src:o.image,alt:"Film poster for {0}".format(o.title)}).toggle(!!o.image),$("#filmOriginalTitle").text(o.originalTitle).toggle(!!o.originalTitle),p("#imdbLink","https://www.imdb.com/title/{0}/",o.imdb),p("#letterboxdLink","https://letterboxd.com/film/{0}/",o.letterboxd),p("#rottenTomatoesLink","https://www.rottentomatoes.com/m/{0}",o.rottenTomatoes),p("#wikipediaLink","https://en.wikipedia.org/wiki/{0}",o.wikipedia),p("#justwatchLink","https://www.justwatch.com/uk/movie/{0}",o.justwatch),p("#trailerLink",e,o.trailer),p("#reviewLink",e,o.review),$("#filmReviewer").text(o.reviewer),$("#filmDetailsModal").modal())}function p(t,e,o){$(t).prop({href:e.format(o)}).toggle(!!o)}function g(t){return"US-DC"===t.stateCode?"https://upload.wikimedia.org/wikipedia/commons/d/d4/Flag_of_the_District_of_Columbia.svg":"https://flagcdn.com/{0}.svg".format(t.stateCode.toLowerCase())}$("a").prop("target","_blank"),$("#btnShowMap").click((function(){f("#btnShowMap"),u("#sectionMap"),s()})),$("#btnShowListStates").click((function(){f("#btnShowListStates"),u("#sectionListStates"),l()})),$("#btnShowListMovies").click((function(){f("#btnShowListMovies"),u("#sectionListMovies"),l()})),$("#btnShowAbout").click((function(){f("#btnShowAbout"),u("#sectionAbout"),l()})),$("#filmStateFlag").on({error:function(){$(this).hide()},load:function(){$(this).show()}}),r=function(){$("#filmCount").text(n.length),s(),c("#listStates",n,(function(t){return t.state}),(function(t){return"{0} ({1})".format(t.title,t.year)})),c("#listMovies",a,(function(t){return"{0} ({1})".format(t.title,t.year)}),(function(t){return t.state}))},n=[],a=[],i={},$.getJSON("data/films.json",(function(e){e.forEach((function(e){e.colour=function(){let e=Math.floor(Math.random()*t.length);return t[e]}(),i[e.stateCode]=e})),n=e.sort((function(t,e){return t.state<e.state?-1:t.state>e.state?1:0})),a=e.slice().sort((function(t,e){let o=t.title.sortable(),i=e.title.sortable();return o<i?-1:o>i?1:0})),r()})),String.prototype.format=function(){let t=this;for(let e=0;e<arguments.length;e++)t=t.replace("{"+e+"}",arguments[e]);return t},String.prototype.sortable=function(){return this.replace(/^(A|The) /,"")}}));